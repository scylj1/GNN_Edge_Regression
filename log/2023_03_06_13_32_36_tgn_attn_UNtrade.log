2023-03-06 13:32:36,503 - root - INFO - Namespace(data='UNtrade', bs=200, prefix='tgn_attn', n_degree=10, n_head=2, n_epoch=50, n_layer=1, lr=0.0001, patience=5, n_runs=5, drop_out=0.1, gpu=2, node_dim=100, time_dim=100, backprop_every=1, use_memory=True, embedding_module='graph_attention', message_function='identity', memory_updater='gru', aggregator='last', memory_update_at_end=False, message_dim=100, memory_dim=172, different_new_nodes=False, uniform=False, randomize_features=False, use_destination_embedding_in_message=False, use_source_embedding_in_message=False, dyrep=False, val_ratio=0.15, test_ratio=0.15)
2023-03-06 13:32:39,563 - root - INFO - ************************************
2023-03-06 13:32:39,564 - root - INFO - ********** Run 0 starts. **********
2023-03-06 13:32:41,088 - root - INFO - num of training instances: 278721
2023-03-06 13:32:41,088 - root - INFO - num of batches per epoch: 1394
2023-03-06 13:32:41,089 - root - INFO - start 0 epoch
2023-03-06 13:33:35,109 - root - INFO - epoch: 0 took 54.02s
2023-03-06 13:33:35,109 - root - INFO - Epoch mean loss: 0.008430467652900996
2023-03-06 13:33:35,109 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.0003385015003943766, new node val loss base: 0.00019404371638802434, new node val loss: 0.00042325673114149186
2023-03-06 13:33:35,134 - root - INFO - start 1 epoch
2023-03-06 13:34:28,375 - root - INFO - epoch: 1 took 53.26s
2023-03-06 13:34:28,375 - root - INFO - Epoch mean loss: 0.0005874854944221242
2023-03-06 13:34:28,375 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.0002723807892082641, new node val loss base: 0.00019404371638802434, new node val loss: 0.0002995239458440243
2023-03-06 13:34:28,388 - root - INFO - start 2 epoch
2023-03-06 13:35:21,378 - root - INFO - epoch: 2 took 53.00s
2023-03-06 13:35:21,378 - root - INFO - Epoch mean loss: 0.0002927841807392921
2023-03-06 13:35:21,378 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.0002327502982427025, new node val loss base: 0.00019404371638802434, new node val loss: 0.0002336607120736902
2023-03-06 13:35:21,392 - root - INFO - start 3 epoch
2023-03-06 13:36:14,443 - root - INFO - epoch: 3 took 53.06s
2023-03-06 13:36:14,444 - root - INFO - Epoch mean loss: 0.00021713436024911817
2023-03-06 13:36:14,444 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00041494282805329684, new node val loss base: 0.00019404371638802434, new node val loss: 0.00042280144719795753
2023-03-06 13:36:14,455 - root - INFO - start 4 epoch
2023-03-06 13:37:05,290 - root - INFO - epoch: 4 took 50.84s
2023-03-06 13:37:05,290 - root - INFO - Epoch mean loss: 0.0002109850874040529
2023-03-06 13:37:05,290 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00022752521767185443, new node val loss base: 0.00019404371638802434, new node val loss: 0.00025768936765762745
2023-03-06 13:37:05,306 - root - INFO - start 5 epoch
2023-03-06 13:37:57,806 - root - INFO - epoch: 5 took 52.51s
2023-03-06 13:37:57,806 - root - INFO - Epoch mean loss: 0.0001850804003751073
2023-03-06 13:37:57,806 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00030405443445654626, new node val loss base: 0.00019404371638802434, new node val loss: 0.0003340637464697104
2023-03-06 13:37:57,824 - root - INFO - start 6 epoch
2023-03-06 13:38:49,112 - root - INFO - epoch: 6 took 51.30s
2023-03-06 13:38:49,112 - root - INFO - Epoch mean loss: 0.0009536590179525783
2023-03-06 13:38:49,112 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00021781049752420717, new node val loss base: 0.00019404371638802434, new node val loss: 0.00019931383591040264
2023-03-06 13:38:49,124 - root - INFO - start 7 epoch
2023-03-06 13:39:41,925 - root - INFO - epoch: 7 took 52.81s
2023-03-06 13:39:41,925 - root - INFO - Epoch mean loss: 0.0001366082284258137
2023-03-06 13:39:41,925 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00022295000896504298, new node val loss base: 0.00019404371638802434, new node val loss: 0.00020726400042305905
2023-03-06 13:39:41,938 - root - INFO - start 8 epoch
2023-03-06 13:40:35,078 - root - INFO - epoch: 8 took 53.15s
2023-03-06 13:40:35,078 - root - INFO - Epoch mean loss: 0.00013628069611652972
2023-03-06 13:40:35,078 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00021858428801804503, new node val loss base: 0.00019404371638802434, new node val loss: 0.0001982399170009472
2023-03-06 13:40:35,090 - root - INFO - start 9 epoch
2023-03-06 13:41:27,567 - root - INFO - epoch: 9 took 52.48s
2023-03-06 13:41:27,567 - root - INFO - Epoch mean loss: 0.00013399259554191536
2023-03-06 13:41:27,567 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00021762644058049858, new node val loss base: 0.00019404371638802434, new node val loss: 0.00019779479969238238
2023-03-06 13:41:27,578 - root - INFO - start 10 epoch
2023-03-06 13:42:20,205 - root - INFO - epoch: 10 took 52.63s
2023-03-06 13:42:20,205 - root - INFO - Epoch mean loss: 0.00013418439587633646
2023-03-06 13:42:20,205 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00021908951132583522, new node val loss base: 0.00019404371638802434, new node val loss: 0.00019945913562427744
2023-03-06 13:42:20,221 - root - INFO - start 11 epoch
2023-03-06 13:43:12,634 - root - INFO - epoch: 11 took 52.42s
2023-03-06 13:43:12,635 - root - INFO - Epoch mean loss: 0.0001338756920669735
2023-03-06 13:43:12,635 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00021756834691924896, new node val loss base: 0.00019404371638802434, new node val loss: 0.00019630766377819674
2023-03-06 13:43:12,654 - root - INFO - start 12 epoch
2023-03-06 13:44:05,138 - root - INFO - epoch: 12 took 52.50s
2023-03-06 13:44:05,138 - root - INFO - Epoch mean loss: 0.00013412392561284775
2023-03-06 13:44:05,139 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.0002176489480342815, new node val loss base: 0.00019404371638802434, new node val loss: 0.0001965613000287043
2023-03-06 13:44:05,150 - root - INFO - start 13 epoch
2023-03-06 13:44:56,866 - root - INFO - epoch: 13 took 51.72s
2023-03-06 13:44:56,866 - root - INFO - Epoch mean loss: 0.00013402327646571785
2023-03-06 13:44:56,866 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00021764010139426238, new node val loss base: 0.00019404371638802434, new node val loss: 0.00019638206761150886
2023-03-06 13:44:56,877 - root - INFO - start 14 epoch
2023-03-06 13:45:50,044 - root - INFO - epoch: 14 took 53.17s
2023-03-06 13:45:50,045 - root - INFO - Epoch mean loss: 0.00013378614267606058
2023-03-06 13:45:50,045 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00021754165755277606, new node val loss base: 0.00019404371638802434, new node val loss: 0.00019631221019545143
2023-03-06 13:45:50,057 - root - INFO - start 15 epoch
2023-03-06 13:46:43,507 - root - INFO - epoch: 15 took 53.46s
2023-03-06 13:46:43,507 - root - INFO - Epoch mean loss: 0.00013398621351760732
2023-03-06 13:46:43,507 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00021740660435187484, new node val loss base: 0.00019404371638802434, new node val loss: 0.00019606982701558188
2023-03-06 13:46:43,519 - root - INFO - start 16 epoch
2023-03-06 13:47:36,879 - root - INFO - epoch: 16 took 53.37s
2023-03-06 13:47:36,880 - root - INFO - Epoch mean loss: 0.00013428394026060585
2023-03-06 13:47:36,880 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00021724584317671624, new node val loss base: 0.00019404371638802434, new node val loss: 0.00019586122250270308
2023-03-06 13:47:36,897 - root - INFO - start 17 epoch
2023-03-06 13:48:29,421 - root - INFO - epoch: 17 took 52.54s
2023-03-06 13:48:29,421 - root - INFO - Epoch mean loss: 0.00013416565719066875
2023-03-06 13:48:29,421 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00021834577586605751, new node val loss base: 0.00019404371638802434, new node val loss: 0.00019705338857434312
2023-03-06 13:48:29,433 - root - INFO - start 18 epoch
2023-03-06 13:49:22,074 - root - INFO - epoch: 18 took 52.65s
2023-03-06 13:49:22,074 - root - INFO - Epoch mean loss: 0.00013344042172758563
2023-03-06 13:49:22,074 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.0002197018100599132, new node val loss base: 0.00019404371638802434, new node val loss: 0.0001984451433295599
2023-03-06 13:49:22,089 - root - INFO - start 19 epoch
2023-03-06 13:50:15,636 - root - INFO - epoch: 19 took 53.56s
2023-03-06 13:50:15,636 - root - INFO - Epoch mean loss: 0.00013309349894135496
2023-03-06 13:50:15,636 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00022031222833596647, new node val loss base: 0.00019404371638802434, new node val loss: 0.00019906820074976016
2023-03-06 13:50:15,654 - root - INFO - start 20 epoch
2023-03-06 13:51:06,252 - root - INFO - epoch: 20 took 50.61s
2023-03-06 13:51:06,252 - root - INFO - Epoch mean loss: 0.00013282890762030612
2023-03-06 13:51:06,252 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00022020964125074382, new node val loss base: 0.00019404371638802434, new node val loss: 0.00019896373593523758
2023-03-06 13:51:06,265 - root - INFO - start 21 epoch
2023-03-06 13:51:59,948 - root - INFO - epoch: 21 took 53.69s
2023-03-06 13:51:59,948 - root - INFO - Epoch mean loss: 0.00013268760343313144
2023-03-06 13:51:59,948 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00021966245513009762, new node val loss base: 0.00019404371638802434, new node val loss: 0.00019840358879662335
2023-03-06 13:51:59,948 - root - INFO - No improvement over 5 epochs, stop training
2023-03-06 13:51:59,948 - root - INFO - Loading the best model at epoch 16
2023-03-06 13:51:59,953 - root - INFO - Loaded the best model at epoch 16 for inference
2023-03-06 13:52:05,801 - root - INFO - Test statistics: Old nodes -- loss base: 0.0001978986621009706
2023-03-06 13:52:05,802 - root - INFO - Test statistics: Old nodes -- loss: 0.00019837577827613642
2023-03-06 13:52:05,802 - root - INFO - Test statistics: New nodes -- loss base: 0.0001952443265171422
2023-03-06 13:52:05,802 - root - INFO - Test statistics: New nodes -- loss: 0.00019756914055950347
2023-03-06 13:52:05,802 - root - INFO - Saving the model
2023-03-06 13:52:05,862 - root - INFO - TGN model saved
2023-03-06 13:52:05,862 - root - INFO - Run 0, elapsed time: 1166.2987639904022 seconds.
2023-03-06 13:52:05,862 - root - INFO - ************************************
2023-03-06 13:52:05,862 - root - INFO - ********** Run 1 starts. **********
2023-03-06 13:52:05,885 - root - INFO - num of training instances: 278721
2023-03-06 13:52:05,885 - root - INFO - num of batches per epoch: 1394
2023-03-06 13:52:05,886 - root - INFO - start 0 epoch
2023-03-06 13:52:59,378 - root - INFO - epoch: 0 took 53.49s
2023-03-06 13:52:59,378 - root - INFO - Epoch mean loss: 0.005741545948856497
2023-03-06 13:52:59,378 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.0007295835676091619, new node val loss base: 0.00019404371638802434, new node val loss: 0.0009624747152600293
2023-03-06 13:52:59,391 - root - INFO - start 1 epoch
2023-03-06 13:53:52,314 - root - INFO - epoch: 1 took 52.93s
2023-03-06 13:53:52,314 - root - INFO - Epoch mean loss: 0.000415415826738201
2023-03-06 13:53:52,314 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00024730636734461895, new node val loss base: 0.00019404371638802434, new node val loss: 0.0003113653265435391
2023-03-06 13:53:52,327 - root - INFO - start 2 epoch
2023-03-06 13:54:45,737 - root - INFO - epoch: 2 took 53.42s
2023-03-06 13:54:45,737 - root - INFO - Epoch mean loss: 0.00021687077838177665
2023-03-06 13:54:45,737 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00027002665854530545, new node val loss base: 0.00019404371638802434, new node val loss: 0.0002526334282154355
2023-03-06 13:54:45,750 - root - INFO - start 3 epoch
2023-03-06 13:55:39,064 - root - INFO - epoch: 3 took 53.32s
2023-03-06 13:55:39,064 - root - INFO - Epoch mean loss: 0.00019738503269786732
2023-03-06 13:55:39,064 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00025397492226095263, new node val loss base: 0.00019404371638802434, new node val loss: 0.00025434859678209444
2023-03-06 13:55:39,077 - root - INFO - start 4 epoch
2023-03-06 13:56:32,344 - root - INFO - epoch: 4 took 53.27s
2023-03-06 13:56:32,345 - root - INFO - Epoch mean loss: 0.000208868899941184
2023-03-06 13:56:32,345 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00021952167134822273, new node val loss base: 0.00019404371638802434, new node val loss: 0.00020385666551935486
2023-03-06 13:56:32,357 - root - INFO - start 5 epoch
2023-03-06 13:57:25,970 - root - INFO - epoch: 5 took 53.62s
2023-03-06 13:57:25,970 - root - INFO - Epoch mean loss: 0.00014542921663476685
2023-03-06 13:57:25,970 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00023600029579574016, new node val loss base: 0.00019404371638802434, new node val loss: 0.0002245098956137947
2023-03-06 13:57:25,991 - root - INFO - start 6 epoch
2023-03-06 13:58:20,222 - root - INFO - epoch: 6 took 54.24s
2023-03-06 13:58:20,222 - root - INFO - Epoch mean loss: 0.0001407759055015918
2023-03-06 13:58:20,222 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.0002180171892990818, new node val loss base: 0.00019404371638802434, new node val loss: 0.00019913524213952235
2023-03-06 13:58:20,242 - root - INFO - start 7 epoch
2023-03-06 13:59:13,268 - root - INFO - epoch: 7 took 53.04s
2023-03-06 13:59:13,268 - root - INFO - Epoch mean loss: 0.0001356728737668452
2023-03-06 13:59:13,268 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.0002177641909063606, new node val loss base: 0.00019404371638802434, new node val loss: 0.00019889384553001128
2023-03-06 13:59:13,281 - root - INFO - start 8 epoch
2023-03-06 14:00:06,360 - root - INFO - epoch: 8 took 53.09s
2023-03-06 14:00:06,360 - root - INFO - Epoch mean loss: 0.00013431465668129866
2023-03-06 14:00:06,360 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00021876845709523527, new node val loss base: 0.00019404371638802434, new node val loss: 0.00019792418164659453
2023-03-06 14:00:06,379 - root - INFO - start 9 epoch
2023-03-06 14:00:57,674 - root - INFO - epoch: 9 took 51.31s
2023-03-06 14:00:57,674 - root - INFO - Epoch mean loss: 0.00013406527233660455
2023-03-06 14:00:57,675 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00021986216748346503, new node val loss base: 0.00019404371638802434, new node val loss: 0.00019991862000830356
2023-03-06 14:00:57,687 - root - INFO - start 10 epoch
2023-03-06 14:01:50,373 - root - INFO - epoch: 10 took 52.69s
2023-03-06 14:01:50,373 - root - INFO - Epoch mean loss: 0.00013390383788037922
2023-03-06 14:01:50,373 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00021950617407234793, new node val loss base: 0.00019404371638802434, new node val loss: 0.00019831480195761024
2023-03-06 14:01:50,385 - root - INFO - start 11 epoch
2023-03-06 14:02:43,745 - root - INFO - epoch: 11 took 53.37s
2023-03-06 14:02:43,745 - root - INFO - Epoch mean loss: 0.00013333511701419325
2023-03-06 14:02:43,745 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00021983105869864585, new node val loss base: 0.00019404371638802434, new node val loss: 0.00019858332287052516
2023-03-06 14:02:43,757 - root - INFO - start 12 epoch
2023-03-06 14:03:36,884 - root - INFO - epoch: 12 took 53.13s
2023-03-06 14:03:36,884 - root - INFO - Epoch mean loss: 0.000133190095267671
2023-03-06 14:03:36,884 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00022018451564417233, new node val loss base: 0.00019404371638802434, new node val loss: 0.00019884474706881
2023-03-06 14:03:36,884 - root - INFO - No improvement over 5 epochs, stop training
2023-03-06 14:03:36,884 - root - INFO - Loading the best model at epoch 7
2023-03-06 14:03:36,889 - root - INFO - Loaded the best model at epoch 7 for inference
2023-03-06 14:03:42,741 - root - INFO - Test statistics: Old nodes -- loss base: 0.0001978986621009706
2023-03-06 14:03:42,741 - root - INFO - Test statistics: Old nodes -- loss: 0.00019861496937294154
2023-03-06 14:03:42,741 - root - INFO - Test statistics: New nodes -- loss base: 0.0001952443265171422
2023-03-06 14:03:42,741 - root - INFO - Test statistics: New nodes -- loss: 0.00019782248514074586
2023-03-06 14:03:42,741 - root - INFO - Saving the model
2023-03-06 14:03:42,799 - root - INFO - TGN model saved
2023-03-06 14:03:42,799 - root - INFO - Run 1, elapsed time: 696.9368348121643 seconds.
2023-03-06 14:03:42,799 - root - INFO - ************************************
2023-03-06 14:03:42,799 - root - INFO - ********** Run 2 starts. **********
2023-03-06 14:03:42,816 - root - INFO - num of training instances: 278721
2023-03-06 14:03:42,816 - root - INFO - num of batches per epoch: 1394
2023-03-06 14:03:42,817 - root - INFO - start 0 epoch
2023-03-06 14:04:36,119 - root - INFO - epoch: 0 took 53.30s
2023-03-06 14:04:36,119 - root - INFO - Epoch mean loss: 0.008004914287353634
2023-03-06 14:04:36,119 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.0009957579226245008, new node val loss base: 0.00019404371638802434, new node val loss: 0.0014151541453401295
2023-03-06 14:04:36,132 - root - INFO - start 1 epoch
2023-03-06 14:05:28,596 - root - INFO - epoch: 1 took 52.47s
2023-03-06 14:05:28,597 - root - INFO - Epoch mean loss: 0.0005060020459033794
2023-03-06 14:05:28,597 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.0002954419180806435, new node val loss base: 0.00019404371638802434, new node val loss: 0.0003387168665542008
2023-03-06 14:05:28,610 - root - INFO - start 2 epoch
2023-03-06 14:06:20,787 - root - INFO - epoch: 2 took 52.18s
2023-03-06 14:06:20,787 - root - INFO - Epoch mean loss: 0.00025075518763004786
2023-03-06 14:06:20,787 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00023578811714351417, new node val loss base: 0.00019404371638802434, new node val loss: 0.0002708755879006817
2023-03-06 14:06:20,800 - root - INFO - start 3 epoch
2023-03-06 14:07:13,093 - root - INFO - epoch: 3 took 52.30s
2023-03-06 14:07:13,093 - root - INFO - Epoch mean loss: 0.00019558268967994003
2023-03-06 14:07:13,093 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.0002318498890307075, new node val loss base: 0.00019404371638802434, new node val loss: 0.00022826854468183667
2023-03-06 14:07:13,106 - root - INFO - start 4 epoch
2023-03-06 14:08:06,616 - root - INFO - epoch: 4 took 53.52s
2023-03-06 14:08:06,616 - root - INFO - Epoch mean loss: 0.00017458431868331507
2023-03-06 14:08:06,616 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.0002560891430481808, new node val loss base: 0.00019404371638802434, new node val loss: 0.00024467232165807705
2023-03-06 14:08:06,629 - root - INFO - start 5 epoch
2023-03-06 14:08:59,723 - root - INFO - epoch: 5 took 53.10s
2023-03-06 14:08:59,723 - root - INFO - Epoch mean loss: 0.00021603928116690555
2023-03-06 14:08:59,723 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.0011970605008771967, new node val loss base: 0.00019404371638802434, new node val loss: 0.0015486722486725754
2023-03-06 14:08:59,736 - root - INFO - start 6 epoch
2023-03-06 14:09:52,976 - root - INFO - epoch: 6 took 53.25s
2023-03-06 14:09:52,976 - root - INFO - Epoch mean loss: 0.00018035305279157302
2023-03-06 14:09:52,976 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00021968745528164568, new node val loss base: 0.00019404371638802434, new node val loss: 0.00020782290242268083
2023-03-06 14:09:52,989 - root - INFO - start 7 epoch
2023-03-06 14:10:45,862 - root - INFO - epoch: 7 took 52.88s
2023-03-06 14:10:45,862 - root - INFO - Epoch mean loss: 0.00013442534955424896
2023-03-06 14:10:45,862 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.000217665872218423, new node val loss base: 0.00019404371638802434, new node val loss: 0.00019771780562156404
2023-03-06 14:10:45,875 - root - INFO - start 8 epoch
2023-03-06 14:11:39,306 - root - INFO - epoch: 8 took 53.44s
2023-03-06 14:11:39,307 - root - INFO - Epoch mean loss: 0.0001336967712512136
2023-03-06 14:11:39,307 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.000219240584194156, new node val loss base: 0.00019404371638802434, new node val loss: 0.00020869891826472814
2023-03-06 14:11:39,320 - root - INFO - start 9 epoch
2023-03-06 14:12:32,698 - root - INFO - epoch: 9 took 53.38s
2023-03-06 14:12:32,698 - root - INFO - Epoch mean loss: 0.00013434132604749186
2023-03-06 14:12:32,698 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00021729125742229641, new node val loss base: 0.00019404371638802434, new node val loss: 0.00019603644356192113
2023-03-06 14:12:32,711 - root - INFO - start 10 epoch
2023-03-06 14:13:25,744 - root - INFO - epoch: 10 took 53.04s
2023-03-06 14:13:25,745 - root - INFO - Epoch mean loss: 0.00013548328310999944
2023-03-06 14:13:25,745 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.0002173831800562605, new node val loss base: 0.00019404371638802434, new node val loss: 0.0001974058228801706
2023-03-06 14:13:25,757 - root - INFO - start 11 epoch
2023-03-06 14:14:18,922 - root - INFO - epoch: 11 took 53.17s
2023-03-06 14:14:18,922 - root - INFO - Epoch mean loss: 0.0001341943579531177
2023-03-06 14:14:18,922 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.0002175061265615325, new node val loss base: 0.00019404371638802434, new node val loss: 0.0001989596772581113
2023-03-06 14:14:18,936 - root - INFO - start 12 epoch
2023-03-06 14:15:11,961 - root - INFO - epoch: 12 took 53.03s
2023-03-06 14:15:11,962 - root - INFO - Epoch mean loss: 0.0001338854495561297
2023-03-06 14:15:11,962 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00021736080714593667, new node val loss base: 0.00019404371638802434, new node val loss: 0.00019594337441266967
2023-03-06 14:15:11,975 - root - INFO - start 13 epoch
2023-03-06 14:16:05,567 - root - INFO - epoch: 13 took 53.60s
2023-03-06 14:16:05,567 - root - INFO - Epoch mean loss: 0.00013376285373625606
2023-03-06 14:16:05,567 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00021718614568425323, new node val loss base: 0.00019404371638802434, new node val loss: 0.00019604379430125025
2023-03-06 14:16:05,580 - root - INFO - start 14 epoch
2023-03-06 14:16:59,303 - root - INFO - epoch: 14 took 53.73s
2023-03-06 14:16:59,304 - root - INFO - Epoch mean loss: 0.00013384698377084484
2023-03-06 14:16:59,304 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00021780111595809967, new node val loss base: 0.00019404371638802434, new node val loss: 0.0001964826018245944
2023-03-06 14:16:59,316 - root - INFO - start 15 epoch
2023-03-06 14:17:53,487 - root - INFO - epoch: 15 took 54.18s
2023-03-06 14:17:53,487 - root - INFO - Epoch mean loss: 0.0001335322513004643
2023-03-06 14:17:53,487 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00021848909628970032, new node val loss base: 0.00019404371638802434, new node val loss: 0.0001971974272462171
2023-03-06 14:17:53,506 - root - INFO - start 16 epoch
2023-03-06 14:19:00,548 - root - INFO - epoch: 16 took 67.05s
2023-03-06 14:19:00,548 - root - INFO - Epoch mean loss: 0.00013331734352940825
2023-03-06 14:19:00,548 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00021983844687969626, new node val loss base: 0.00019404371638802434, new node val loss: 0.0001985827546951271
2023-03-06 14:19:00,572 - root - INFO - start 17 epoch
2023-03-06 14:20:09,387 - root - INFO - epoch: 17 took 68.83s
2023-03-06 14:20:09,387 - root - INFO - Epoch mean loss: 0.00013307723657200615
2023-03-06 14:20:09,387 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00022018577025529484, new node val loss base: 0.00019404371638802434, new node val loss: 0.00019894552325157189
2023-03-06 14:20:09,412 - root - INFO - start 18 epoch
2023-03-06 14:21:23,561 - root - INFO - epoch: 18 took 74.17s
2023-03-06 14:21:23,562 - root - INFO - Epoch mean loss: 0.0001352988817559807
2023-03-06 14:21:23,562 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00021967867501686798, new node val loss base: 0.00019404371638802434, new node val loss: 0.00019834874173488466
2023-03-06 14:21:23,562 - root - INFO - No improvement over 5 epochs, stop training
2023-03-06 14:21:23,562 - root - INFO - Loading the best model at epoch 13
2023-03-06 14:21:23,571 - root - INFO - Loaded the best model at epoch 13 for inference
2023-03-06 14:21:32,291 - root - INFO - Test statistics: Old nodes -- loss base: 0.0001978986621009706
2023-03-06 14:21:32,291 - root - INFO - Test statistics: Old nodes -- loss: 0.00019834497323682328
2023-03-06 14:21:32,291 - root - INFO - Test statistics: New nodes -- loss base: 0.0001952443265171422
2023-03-06 14:21:32,291 - root - INFO - Test statistics: New nodes -- loss: 0.00019752911799926284
2023-03-06 14:21:32,291 - root - INFO - Saving the model
2023-03-06 14:21:32,938 - root - INFO - TGN model saved
2023-03-06 14:21:32,938 - root - INFO - Run 2, elapsed time: 1070.139503479004 seconds.
2023-03-06 14:21:32,938 - root - INFO - ************************************
2023-03-06 14:21:32,938 - root - INFO - ********** Run 3 starts. **********
2023-03-06 14:21:32,991 - root - INFO - num of training instances: 278721
2023-03-06 14:21:32,992 - root - INFO - num of batches per epoch: 1394
2023-03-06 14:21:33,006 - root - INFO - start 0 epoch
2023-03-06 14:22:47,651 - root - INFO - epoch: 0 took 74.66s
2023-03-06 14:22:47,651 - root - INFO - Epoch mean loss: 0.0095665869126316
2023-03-06 14:22:47,651 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.0016298535739905022, new node val loss base: 0.00019404371638802434, new node val loss: 0.0014854720346071503
2023-03-06 14:22:47,696 - root - INFO - start 1 epoch
2023-03-06 14:23:58,181 - root - INFO - epoch: 1 took 70.52s
2023-03-06 14:23:58,183 - root - INFO - Epoch mean loss: 0.0005438139185563515
2023-03-06 14:23:58,183 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00027854463933365756, new node val loss base: 0.00019404371638802434, new node val loss: 0.0003033156242728694
2023-03-06 14:23:58,270 - root - INFO - start 2 epoch
2023-03-06 14:25:11,305 - root - INFO - epoch: 2 took 73.09s
2023-03-06 14:25:11,305 - root - INFO - Epoch mean loss: 0.0002496090862629169
2023-03-06 14:25:11,305 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00024965685160545354, new node val loss base: 0.00019404371638802434, new node val loss: 0.00023678607967033392
2023-03-06 14:25:11,324 - root - INFO - start 3 epoch
2023-03-06 14:26:26,341 - root - INFO - epoch: 3 took 75.03s
2023-03-06 14:26:26,341 - root - INFO - Epoch mean loss: 0.00017637513616250054
2023-03-06 14:26:26,341 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00022975497385126141, new node val loss base: 0.00019404371638802434, new node val loss: 0.0002293179157810382
2023-03-06 14:26:26,362 - root - INFO - start 4 epoch
2023-03-06 14:27:41,787 - root - INFO - epoch: 4 took 75.44s
2023-03-06 14:27:41,805 - root - INFO - Epoch mean loss: 0.0001891207380445272
2023-03-06 14:27:41,813 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.0002730324550874814, new node val loss base: 0.00019404371638802434, new node val loss: 0.00025500013819135145
2023-03-06 14:27:42,004 - root - INFO - start 5 epoch
2023-03-06 14:28:52,340 - root - INFO - epoch: 5 took 70.40s
2023-03-06 14:28:52,340 - root - INFO - Epoch mean loss: 0.00027429187949994577
2023-03-06 14:28:52,340 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00022295249285475362, new node val loss base: 0.00019404371638802434, new node val loss: 0.00020277041297375484
2023-03-06 14:28:52,360 - root - INFO - start 6 epoch
2023-03-06 14:30:03,351 - root - INFO - epoch: 6 took 71.00s
2023-03-06 14:30:03,352 - root - INFO - Epoch mean loss: 0.00013720594606102956
2023-03-06 14:30:03,352 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00022553338633076408, new node val loss base: 0.00019404371638802434, new node val loss: 0.0002118531007852587
2023-03-06 14:30:03,372 - root - INFO - start 7 epoch
2023-03-06 14:31:13,349 - root - INFO - epoch: 7 took 69.99s
2023-03-06 14:31:13,349 - root - INFO - Epoch mean loss: 0.00013703652507281633
2023-03-06 14:31:13,349 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00021856441603835836, new node val loss base: 0.00019404371638802434, new node val loss: 0.0001986895932452516
2023-03-06 14:31:13,368 - root - INFO - start 8 epoch
2023-03-06 14:32:25,208 - root - INFO - epoch: 8 took 71.85s
2023-03-06 14:32:25,209 - root - INFO - Epoch mean loss: 0.00013763986203853032
2023-03-06 14:32:25,209 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00021840090739118253, new node val loss base: 0.00019404371638802434, new node val loss: 0.00019791953871701293
2023-03-06 14:32:25,233 - root - INFO - start 9 epoch
2023-03-06 14:33:39,754 - root - INFO - epoch: 9 took 74.54s
2023-03-06 14:33:39,754 - root - INFO - Epoch mean loss: 0.00013407822174936931
2023-03-06 14:33:39,754 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00022021163770598095, new node val loss base: 0.00019404371638802434, new node val loss: 0.00019939404543293076
2023-03-06 14:33:39,774 - root - INFO - start 10 epoch
2023-03-06 14:34:52,198 - root - INFO - epoch: 10 took 72.44s
2023-03-06 14:34:52,198 - root - INFO - Epoch mean loss: 0.00013386770099705006
2023-03-06 14:34:52,198 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00021882901061570753, new node val loss base: 0.00019404371638802434, new node val loss: 0.00019761391917032427
2023-03-06 14:34:52,214 - root - INFO - start 11 epoch
2023-03-06 14:36:05,028 - root - INFO - epoch: 11 took 72.82s
2023-03-06 14:36:05,028 - root - INFO - Epoch mean loss: 0.00013372856715276435
2023-03-06 14:36:05,028 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.0002180821714140079, new node val loss base: 0.00019404371638802434, new node val loss: 0.00019711772932003635
2023-03-06 14:36:05,050 - root - INFO - start 12 epoch
2023-03-06 14:37:18,551 - root - INFO - epoch: 12 took 73.52s
2023-03-06 14:37:18,552 - root - INFO - Epoch mean loss: 0.00013382758490988248
2023-03-06 14:37:18,552 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00021886033565411616, new node val loss base: 0.00019404371638802434, new node val loss: 0.00019775916064914412
2023-03-06 14:37:18,620 - root - INFO - start 13 epoch
2023-03-06 14:38:30,674 - root - INFO - epoch: 13 took 72.11s
2023-03-06 14:38:30,674 - root - INFO - Epoch mean loss: 0.0001334072665241631
2023-03-06 14:38:30,674 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.0002195010064269302, new node val loss base: 0.00019404371638802434, new node val loss: 0.00020018946583175352
2023-03-06 14:38:30,693 - root - INFO - start 14 epoch
2023-03-06 14:39:44,379 - root - INFO - epoch: 14 took 73.70s
2023-03-06 14:39:44,379 - root - INFO - Epoch mean loss: 0.00013346074029300977
2023-03-06 14:39:44,379 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.0002194779069245821, new node val loss base: 0.00019404371638802434, new node val loss: 0.00019835346081384863
2023-03-06 14:39:44,398 - root - INFO - start 15 epoch
2023-03-06 14:40:57,852 - root - INFO - epoch: 15 took 73.47s
2023-03-06 14:40:57,852 - root - INFO - Epoch mean loss: 0.0001330551223625124
2023-03-06 14:40:57,852 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.0002203251986617186, new node val loss base: 0.00019404371638802434, new node val loss: 0.00019908487123606876
2023-03-06 14:40:57,866 - root - INFO - start 16 epoch
2023-03-06 14:42:10,690 - root - INFO - epoch: 16 took 72.83s
2023-03-06 14:42:10,690 - root - INFO - Epoch mean loss: 0.0001350175663600806
2023-03-06 14:42:10,691 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00021939188527154264, new node val loss base: 0.00019404371638802434, new node val loss: 0.0002015161974644917
2023-03-06 14:42:10,691 - root - INFO - No improvement over 5 epochs, stop training
2023-03-06 14:42:10,691 - root - INFO - Loading the best model at epoch 11
2023-03-06 14:42:10,695 - root - INFO - Loaded the best model at epoch 11 for inference
2023-03-06 14:42:18,702 - root - INFO - Test statistics: Old nodes -- loss base: 0.0001978986621009706
2023-03-06 14:42:18,702 - root - INFO - Test statistics: Old nodes -- loss: 0.0001990848732181262
2023-03-06 14:42:18,702 - root - INFO - Test statistics: New nodes -- loss base: 0.0001952443265171422
2023-03-06 14:42:18,702 - root - INFO - Test statistics: New nodes -- loss: 0.00019830650140565076
2023-03-06 14:42:18,702 - root - INFO - Saving the model
2023-03-06 14:42:18,761 - root - INFO - TGN model saved
2023-03-06 14:42:18,762 - root - INFO - Run 3, elapsed time: 1245.8231661319733 seconds.
2023-03-06 14:42:18,762 - root - INFO - ************************************
2023-03-06 14:42:18,762 - root - INFO - ********** Run 4 starts. **********
2023-03-06 14:42:18,784 - root - INFO - num of training instances: 278721
2023-03-06 14:42:18,784 - root - INFO - num of batches per epoch: 1394
2023-03-06 14:42:18,791 - root - INFO - start 0 epoch
2023-03-06 14:43:34,240 - root - INFO - epoch: 0 took 75.46s
2023-03-06 14:43:34,240 - root - INFO - Epoch mean loss: 0.00985416398976965
2023-03-06 14:43:34,240 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.000742650646236259, new node val loss base: 0.00019404371638802434, new node val loss: 0.0008907647743323904
2023-03-06 14:43:34,259 - root - INFO - start 1 epoch
2023-03-06 14:44:48,258 - root - INFO - epoch: 1 took 74.01s
2023-03-06 14:44:48,258 - root - INFO - Epoch mean loss: 0.0005836282739561555
2023-03-06 14:44:48,258 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00027887867803092864, new node val loss base: 0.00019404371638802434, new node val loss: 0.00031604045551525997
2023-03-06 14:44:48,276 - root - INFO - start 2 epoch
2023-03-06 14:46:03,021 - root - INFO - epoch: 2 took 74.76s
2023-03-06 14:46:03,021 - root - INFO - Epoch mean loss: 0.00041987868193196375
2023-03-06 14:46:03,021 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.0003406831093215072, new node val loss base: 0.00019404371638802434, new node val loss: 0.000374834643699257
2023-03-06 14:46:03,040 - root - INFO - start 3 epoch
2023-03-06 14:47:14,380 - root - INFO - epoch: 3 took 71.35s
2023-03-06 14:47:14,380 - root - INFO - Epoch mean loss: 0.0002551195756172264
2023-03-06 14:47:14,381 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.0002517281753272767, new node val loss base: 0.00019404371638802434, new node val loss: 0.00024432560802819685
2023-03-06 14:47:14,400 - root - INFO - start 4 epoch
2023-03-06 14:48:26,270 - root - INFO - epoch: 4 took 71.88s
2023-03-06 14:48:26,270 - root - INFO - Epoch mean loss: 0.00025617500299728713
2023-03-06 14:48:26,270 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00023310105039226056, new node val loss base: 0.00019404371638802434, new node val loss: 0.0002512096287722168
2023-03-06 14:48:26,291 - root - INFO - start 5 epoch
2023-03-06 14:49:41,137 - root - INFO - epoch: 5 took 74.86s
2023-03-06 14:49:41,137 - root - INFO - Epoch mean loss: 0.00019008525328708035
2023-03-06 14:49:41,137 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.0005499955775109935, new node val loss base: 0.00019404371638802434, new node val loss: 0.0006028953885802941
2023-03-06 14:49:41,157 - root - INFO - start 6 epoch
2023-03-06 14:50:56,573 - root - INFO - epoch: 6 took 75.43s
2023-03-06 14:50:56,573 - root - INFO - Epoch mean loss: 0.00018852147049608055
2023-03-06 14:50:56,573 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00021965779312732033, new node val loss base: 0.00019404371638802434, new node val loss: 0.0002029793732869567
2023-03-06 14:50:56,793 - root - INFO - start 7 epoch
2023-03-06 14:52:10,363 - root - INFO - epoch: 7 took 73.78s
2023-03-06 14:52:10,363 - root - INFO - Epoch mean loss: 0.00013811510103620334
2023-03-06 14:52:10,363 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00021950959724107737, new node val loss base: 0.00019404371638802434, new node val loss: 0.00020074177847751484
2023-03-06 14:52:10,382 - root - INFO - start 8 epoch
2023-03-06 14:53:22,239 - root - INFO - epoch: 8 took 71.87s
2023-03-06 14:53:22,240 - root - INFO - Epoch mean loss: 0.0001378493145041961
2023-03-06 14:53:22,240 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00021764620495459526, new node val loss base: 0.00019404371638802434, new node val loss: 0.0001982415030541965
2023-03-06 14:53:22,264 - root - INFO - start 9 epoch
2023-03-06 14:54:37,289 - root - INFO - epoch: 9 took 75.04s
2023-03-06 14:54:37,289 - root - INFO - Epoch mean loss: 0.00013575293430932007
2023-03-06 14:54:37,289 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.000217288488635431, new node val loss base: 0.00019404371638802434, new node val loss: 0.0001959882776276428
2023-03-06 14:54:37,334 - root - INFO - start 10 epoch
2023-03-06 14:55:51,067 - root - INFO - epoch: 10 took 73.77s
2023-03-06 14:55:51,067 - root - INFO - Epoch mean loss: 0.0001364804443186386
2023-03-06 14:55:51,067 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00021864163046102504, new node val loss base: 0.00019404371638802434, new node val loss: 0.0001984789110324955
2023-03-06 14:55:51,087 - root - INFO - start 11 epoch
2023-03-06 14:57:04,436 - root - INFO - epoch: 11 took 73.36s
2023-03-06 14:57:04,436 - root - INFO - Epoch mean loss: 0.000137919828353958
2023-03-06 14:57:04,436 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00021722705294188412, new node val loss base: 0.00019404371638802434, new node val loss: 0.00019591714045457773
2023-03-06 14:57:04,451 - root - INFO - start 12 epoch
2023-03-06 14:58:17,955 - root - INFO - epoch: 12 took 73.51s
2023-03-06 14:58:17,955 - root - INFO - Epoch mean loss: 0.00013503717981145057
2023-03-06 14:58:17,955 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.0002176838409218731, new node val loss base: 0.00019404371638802434, new node val loss: 0.00019666040754757328
2023-03-06 14:58:17,974 - root - INFO - start 13 epoch
2023-03-06 14:59:30,252 - root - INFO - epoch: 13 took 72.29s
2023-03-06 14:59:30,252 - root - INFO - Epoch mean loss: 0.0001356641823471089
2023-03-06 14:59:30,252 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00021732967804187898, new node val loss base: 0.00019404371638802434, new node val loss: 0.00019597959214494475
2023-03-06 14:59:30,280 - root - INFO - start 14 epoch
2023-03-06 15:00:40,274 - root - INFO - epoch: 14 took 70.01s
2023-03-06 15:00:40,275 - root - INFO - Epoch mean loss: 0.0001347029448466367
2023-03-06 15:00:40,275 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00021759950010242612, new node val loss base: 0.00019404371638802434, new node val loss: 0.0001961837898553666
2023-03-06 15:00:40,290 - root - INFO - start 15 epoch
2023-03-06 15:01:54,798 - root - INFO - epoch: 15 took 74.52s
2023-03-06 15:01:54,798 - root - INFO - Epoch mean loss: 0.00013483200648043895
2023-03-06 15:01:54,798 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.0002175675464727678, new node val loss base: 0.00019404371638802434, new node val loss: 0.0001961468107917195
2023-03-06 15:01:54,819 - root - INFO - start 16 epoch
2023-03-06 15:03:06,422 - root - INFO - epoch: 16 took 71.62s
2023-03-06 15:03:06,422 - root - INFO - Epoch mean loss: 0.0001345375389496831
2023-03-06 15:03:06,422 - root - INFO - val loss base: 0.00021679614163526485, val loss: 0.00021730112834132394, new node val loss base: 0.00019404371638802434, new node val loss: 0.00019590016294785965
2023-03-06 15:03:06,422 - root - INFO - No improvement over 5 epochs, stop training
2023-03-06 15:03:06,422 - root - INFO - Loading the best model at epoch 11
2023-03-06 15:03:06,432 - root - INFO - Loaded the best model at epoch 11 for inference
2023-03-06 15:03:14,585 - root - INFO - Test statistics: Old nodes -- loss base: 0.0001978986621009706
2023-03-06 15:03:14,585 - root - INFO - Test statistics: Old nodes -- loss: 0.00019834630498015668
2023-03-06 15:03:14,585 - root - INFO - Test statistics: New nodes -- loss base: 0.0001952443265171422
2023-03-06 15:03:14,585 - root - INFO - Test statistics: New nodes -- loss: 0.00019753447640489722
2023-03-06 15:03:14,586 - root - INFO - Saving the model
2023-03-06 15:03:14,644 - root - INFO - TGN model saved
2023-03-06 15:03:14,644 - root - INFO - Run 4, elapsed time: 1255.8824586868286 seconds.
